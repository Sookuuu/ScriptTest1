-- LocalScript educativo: cria uma UI com botão de fechar e controle de FOV
-- Uso: Colocar em StarterPlayerScripts
-- Nota: Este script NÃO implementa ESP nem pulo infinito (funcionalidades de trapaça).
local Players = game:GetService("Players")
local player = Players.LocalPlayer
local playerGui = player:WaitForChild("PlayerGui")
local camera = workspace.CurrentCamera

-- guarda FOV original para restauração
local originalFOV = camera.FieldOfView

-- armazenar conexões pra limpar depois
local connections = {}

-- cria ScreenGui
local screenGui = Instance.new("ScreenGui")
screenGui.Name = "SafeCustomUI"
screenGui.ResetOnSpawn = false
screenGui.Parent = playerGui

-- Frame principal
local mainFrame = Instance.new("Frame")
mainFrame.Name = "MainFrame"
mainFrame.Size = UDim2.new(0, 360, 0, 160)
mainFrame.Position = UDim2.new(0.5, -180, 0.5, -80)
mainFrame.AnchorPoint = Vector2.new(0.5, 0.5)
mainFrame.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
mainFrame.BorderSizePixel = 0
mainFrame.Parent = screenGui

-- Corner & UIStroke (visual)
local corner = Instance.new("UICorner", mainFrame)
corner.CornerRadius = UDim.new(0, 8)
local stroke = Instance.new("UIStroke", mainFrame)
stroke.Color = Color3.fromRGB(45, 45, 45)
stroke.Thickness = 1

-- Title
local title = Instance.new("TextLabel")
title.Name = "Title"
title.Size = UDim2.new(1, -16, 0, 28)
title.Position = UDim2.new(0, 8, 0, 8)
title.BackgroundTransparency = 1
title.Text = "Painel de Controle (educativo)"
title.TextColor3 = Color3.fromRGB(240, 240, 240)
title.Font = Enum.Font.SourceSansBold
title.TextSize = 18
title.TextXAlignment = Enum.TextXAlignment.Left
title.Parent = mainFrame

-- Close button
local closeBtn = Instance.new("TextButton")
closeBtn.Name = "CloseButton"
closeBtn.Size = UDim2.new(0, 36, 0, 24)
closeBtn.Position = UDim2.new(1, -44, 0, 8)
closeBtn.AnchorPoint = Vector2.new(0, 0)
closeBtn.BackgroundColor3 = Color3.fromRGB(200, 60, 60)
closeBtn.Text = "X"
closeBtn.TextColor3 = Color3.new(1,1,1)
closeBtn.Font = Enum.Font.SourceSansBold
closeBtn.TextSize = 18
closeBtn.Parent = mainFrame
local closeCorner = Instance.new("UICorner", closeBtn)
closeCorner.CornerRadius = UDim.new(0,6)

-- FOV label
local fovLabel = Instance.new("TextLabel")
fovLabel.Name = "FOVLabel"
fovLabel.Size = UDim2.new(0, 200, 0, 22)
fovLabel.Position = UDim2.new(0, 12, 0, 48)
fovLabel.BackgroundTransparency = 1
fovLabel.Text = "FOV (Field of View):"
fovLabel.TextColor3 = Color3.fromRGB(220,220,220)
fovLabel.Font = Enum.Font.SourceSans
fovLabel.TextSize = 16
fovLabel.TextXAlignment = Enum.TextXAlignment.Left
fovLabel.Parent = mainFrame

-- TextBox para valor de FOV
local fovBox = Instance.new("TextBox")
fovBox.Name = "FOVBox"
fovBox.Size = UDim2.new(0, 100, 0, 28)
fovBox.Position = UDim2.new(0, 150, 0, 44)
fovBox.Text = tostring(math.floor(originalFOV))
fovBox.PlaceholderText = "Ex: 70"
fovBox.ClearTextOnFocus = false
fovBox.BackgroundColor3 = Color3.fromRGB(240,240,240)
fovBox.TextColor3 = Color3.fromRGB(20,20,20)
fovBox.Font = Enum.Font.SourceSans
fovBox.TextSize = 16
fovBox.Parent = mainFrame
local fovBoxCorner = Instance.new("UICorner", fovBox)
fovBoxCorner.CornerRadius = UDim.new(0,4)

-- Apply button
local applyBtn = Instance.new("TextButton")
applyBtn.Name = "ApplyFOV"
applyBtn.Size = UDim2.new(0, 80, 0, 28)
applyBtn.Position = UDim2.new(0, 260, 0, 44)
applyBtn.Text = "Aplicar"
applyBtn.BackgroundColor3 = Color3.fromRGB(80, 160, 255)
applyBtn.TextColor3 = Color3.new(1,1,1)
applyBtn.Font = Enum.Font.SourceSansBold
applyBtn.TextSize = 16
applyBtn.Parent = mainFrame
local applyCorner = Instance.new("UICorner", applyBtn)
applyCorner.CornerRadius = UDim.new(0,4)

-- Info / aviso embaixo
local info = Instance.new("TextLabel")
info.Name = "Info"
info.Size = UDim2.new(1, -16, 0, 36)
info.Position = UDim2.new(0, 8, 1, -44)
info.BackgroundTransparency = 1
info.Text = "Este painel é educativo. Não implemente ESP/pulo infinito em servidores públicos."
info.TextColor3 = Color3.fromRGB(200,200,200)
info.Font = Enum.Font.SourceSansItalic
info.TextSize = 12
info.TextWrapped = true
info.TextXAlignment = Enum.TextXAlignment.Left
info.Parent = mainFrame

-- Função para aplicar FOV com validação
local function applyFOVFromText(text)
    local val = tonumber(text)
    if not val then
        -- invalid
        fovBox.Text = tostring(math.floor(camera.FieldOfView))
        return
    end
    -- clamp valor (evita valores absurdos)
    val = math.clamp(val, 10, 120)
    camera.FieldOfView = val
    fovBox.Text = tostring(math.floor(val))
end

-- aplicar ao clicar
table.insert(connections, applyBtn.MouseButton1Click:Connect(function()
    applyFOVFromText(fovBox.Text)
end))

-- aplicar ao perder foco (enter/aceitar)
table.insert(connections, fovBox.FocusLost:Connect(function(enterPressed)
    if enterPressed then
        applyFOVFromText(fovBox.Text)
    else
        -- restaura text para o valor atual se o usuário apenas clicou fora
        fovBox.Text = tostring(math.floor(camera.FieldOfView))
    end
end))

-- função para fechar e limpar tudo
local function cleanup()
    -- restaura FOV original
    if camera and camera:IsA("Camera") then
        camera.FieldOfView = originalFOV
    end
    -- desconecta conexões
    for _, con in ipairs(connections) do
        if con and typeof(con) == "RBXScriptConnection" then
            pcall(function() con:Disconnect() end)
        end
    end
    -- destrói UI
    if screenGui and screenGui.Parent then
        screenGui:Destroy()
    end
end

-- botão fechar
table.insert(connections, closeBtn.MouseButton1Click:Connect(function()
    cleanup()
end))

-- limpeza automática ao sair do jogador (precaução)
table.insert(connections, player.AncestryChanged:Connect(function()
    if not player:IsDescendantOf(game) then
        cleanup()
    end
end))

-- mensagem opcional no output para feedback
print("[SafeCustomUI] Interface carregada. Use o campo de FOV para ajustar e X para fechar.")

-- fim do script
